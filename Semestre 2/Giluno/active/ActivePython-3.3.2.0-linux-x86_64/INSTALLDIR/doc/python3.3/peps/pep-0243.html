<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/peps/pep-0001.html for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<head>
  <title>PEP 243 -- Module Repository Upload Mechanism</title>
  <link rel="STYLESHEET" href="style.css" type="text/css" />
</head>
<body bgcolor="white">

<div class="header">
<table border="0">
  <tr><th>PEP:&nbsp;</th><td>243</td></tr>
  <tr><th>Title:&nbsp;</th><td>Module Repository Upload Mechanism</td></tr>
  <tr><th>Version:&nbsp;</th><td>$Revision: 45874 $</td></tr>
  <tr><th>Last-Modified:&nbsp;</th><td><a href="http://svn.python.org/view/peps/trunk/pep-0243.txt">$Date: 2006-05-02 20:52:47 -0700 (Tue, 02 May 2006) $</a> </td></tr>
  <tr><th>Author:&nbsp;</th><td>Sean Reifschneider &lt;jafo-pep&#32;&#97;t&#32;tummy.com&gt;</td></tr>
  <tr><th>Discussions-To:&nbsp;</th><td> &lt;<a href="mailto:distutils-sig&#64;python.org?subject=PEP%20243">distutils-sig&#32;&#97;t&#32;python.org</a>&gt;</td></tr>
  <tr><th>Status:&nbsp;</th><td>Withdrawn</td></tr>
  <tr><th>Type:&nbsp;</th><td>Standards Track</td></tr>
  <tr><th>Created:&nbsp;</th><td>18-Mar-2001</td></tr>
  <tr><th>Python-Version:&nbsp;</th><td>2.1</td></tr>
  <tr><th>Post-History:&nbsp;</th><td>20-Mar-2001, 24-Mar-2001</td></tr>
</table>
</div>
<hr />
<div class="content">
<h3>Abstract</h3>
<pre>
    For a module repository system (such as Perl's CPAN) to be
    successful, it must be as easy as possible for module authors to
    submit their work.  An obvious place for this submit to happen is
    in the Distutils tools after the distribution archive has been
    successfully created.  For example, after a module author has
    tested their software (verifying the results of "setup.py sdist"),
    they might type "setup.py sdist --submit".  This would flag
    Distutils to submit the source distribution to the archive server
    for inclusion and distribution to the mirrors.

    This PEP only deals with the mechanism for submitting the software
    distributions to the archive, and does not deal with the actual
    archive/catalog server.


</pre>
<h3>Upload Process</h3>
<pre>
    The upload will include the Distutils "PKG-INFO" meta-data
    information (as specified in PEP-241 [1]), the actual software
    distribution, and other optional information.  This information
    will be uploaded as a multi-part form encoded the same as a
    regular HTML file upload request.  This form is posted using
    ENCTYPE="multipart/form-data" encoding [2].

    The upload will be made to the host "www.python.org" on port
    80/tcp (POST <a href="http://www.python.org:80/pypi">http://www.python.org:80/pypi</a>).  The form
    will consist of the following fields:

        distribution -- The file containing the module software (for
        example, a .tar.gz or .zip file).

        distmd5sum -- The MD5 hash of the uploaded distribution,
        encoded in ASCII representing the hexadecimal representation
        of the digest ("for byte in digest: s = s + ('%02x' %
        ord(byte))").

        pkginfo (optional) -- The file containing the distribution
        meta-data (as specified in PEP-241 [1]).  Note that if this is
        not included, the distribution file is expected to be in .tar
        format (gzipped and bzipped compreesed are allowed) or .zip
        format, with a "PKG-INFO" file in the top-level directory it
        extracts ("package-1.00/PKG-INFO").

        infomd5sum (required if pkginfo field is present) -- The MD5 hash
        of the uploaded meta-data, encoded in ASCII representing the
        hexadecimal representation of the digest ("for byte in digest:
        s = s + ('%02x' % ord(byte))").

        platform (optional) -- A string representing the target
        platform for this distribution.  This is only for binary
        distributions.  It is encoded as
        "&lt;os_name&gt;-&lt;os_version&gt;-&lt;platform architecture&gt;-&lt;python
        version&gt;".

        signature (optional) -- A OpenPGP-compatible signature [3] of
        the uploaded distribution as signed by the author.  This may
        be used by the cataloging system to automate acceptance of
        uploads.

        protocol_version -- A string indicating the protocol version that
        the client supports.  This document describes protocol version "1".


</pre>
<h3>Return Data</h3>
<pre>
    The status of the upload will be reported using HTTP non-standard
    ("X-*)" headers.  The "X-Swalow-Status" header may have the following
    values:

        SUCCESS -- Indicates that the upload has succeeded.

        FAILURE -- The upload is, for some reason, unable to be
        processed.

        TRYAGAIN -- The server is unable to accept the upload at this
        time, but the client should try again at a later time.
        Potential causes of this are resource shortages on the server,
        administrative down-time, etc...

    Optionally, there may be a "X-Swalow-Reason" header which includes a
    human-readable string which provides more detailed information about
    the "X-Swalow-Status".

    If there is no "X-Swalow-Status" header, or it does not contain one of
    the three strings above, it should be treated as a temporary failure.

    Example:

        &gt;&gt;&gt; f = urllib.urlopen('<a href="http://www.python.org:80/pypi">http://www.python.org:80/pypi</a>')
        &gt;&gt;&gt; s = f.headers['x-swalow-status']
        &gt;&gt;&gt; s = s + ': ' + f.headers.get('x-swalow-reason', '&lt;None&gt;')
        &gt;&gt;&gt; print s
        FAILURE: Required field "distribution" missing.


</pre>
<h3>Sample Form</h3>
<pre>
    The upload client must submit the page in the same form as
    Netscape Navigator version 4.76 for Linux produces when presented
    with the following form:

        &lt;H1&gt;Upload file&lt;/H1&gt;
        &lt;FORM NAME="fileupload" METHOD="POST" ACTION="pypi"
              ENCTYPE="multipart/form-data"&gt;
        &lt;INPUT TYPE="file" NAME="distribution"&gt;&lt;BR&gt;
        &lt;INPUT TYPE="text" NAME="distmd5sum"&gt;&lt;BR&gt;
        &lt;INPUT TYPE="file" NAME="pkginfo"&gt;&lt;BR&gt;
        &lt;INPUT TYPE="text" NAME="infomd5sum"&gt;&lt;BR&gt;
        &lt;INPUT TYPE="text" NAME="platform"&gt;&lt;BR&gt;
        &lt;INPUT TYPE="text" NAME="signature"&gt;&lt;BR&gt;
        &lt;INPUT TYPE="hidden" NAME="protocol_version" VALUE="1"&gt;&lt;BR&gt;
        &lt;INPUT TYPE="SUBMIT" VALUE="Upload"&gt;
        &lt;/FORM&gt;


</pre>
<h3>Platforms</h3>
<pre>
    The following are valid os names:

        aix beos debian dos freebsd hpux mac macos mandrake netbsd
        openbsd qnx redhat solaris suse windows yellowdog

    The above include a number of different types of distributions of
    Linux.  Because of versioning issues these must be split out, and
    it is expected that when it makes sense for one system to use
    distributions made on other similar systems, the download client
    will make the distinction.

    Version is the official version string specified by the vendor for
    the particular release.  For example, "2000" and "nt" (Windows),
    "9.04" (HP-UX), "7.0" (RedHat, Mandrake).

    The following are valid architectures:

        alpha hppa ix86 powerpc sparc ultrasparc


</pre>
<h3>Status</h3>
<pre>
    I currently have a proof-of-concept client and server implemented.
    I plan to have the Distutils patches ready for the 2.1 release.
    Combined with Andrew's PEP-241 [1] for specifying distribution
    meta-data, I hope to have a platform which will allow us to gather
    real-world data for finalizing the catalog system for the 2.2
    release.


</pre>
<h3>References</h3>
<pre>
    [1] Metadata for Python Software Package, Kuchling,
        <a href="http://www.python.org/peps/pep-0241.html">http://www.python.org/peps/pep-0241.html</a>

    [2] <a href="http://www.faqs.org/rfcs/rfc1867.html">RFC 1867</a>, Form-based File Upload in HTML
        <a href="http://www.faqs.org/rfcs/rfc1867.html">http://www.faqs.org/rfcs/rfc1867.html</a>

    [3] <a href="http://www.faqs.org/rfcs/rfc2440.html">RFC 2440</a>, OpenPGP Message Format
        <a href="http://www.faqs.org/rfcs/rfc2440.html">http://www.faqs.org/rfcs/rfc2440.html</a>


</pre>
<h3>Copyright</h3>
<pre>
    This document has been placed in the public domain.


</pre>
</div>
</body>
</html>
