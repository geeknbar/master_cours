<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>


<link rel='start' href='../index.html' title='Python Documentation Index'>
<link rel="first" href="whatsnew23.html" title='What's New in Python 2.3'>
<link rel='contents' href='contents.html' title="Contents">
<link rel='last' href='about.html' title='About this document...'>
<link rel='help' href='about.html' title='About this document...'>
<LINK REL="next" HREF="node17.html">
<LINK REL="prev" href="section-pep305.html">
<LINK REL="parent" HREF="whatsnew23.html">
<LINK REL="next" HREF="node17.html">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name='aesop' content='information'>
<META NAME="description" CONTENT="Extended Slices">
<META NAME="keywords" CONTENT="whatsnew23">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<title>15 Extended Slices</title>
<link rel="stylesheet" href="../style.css" type="text/css">
</head>
<body>
<DIV CLASS="navigation">
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td><a rel="prev" title="14 PEP 307: Pickle" 
  href="section-pep305.html"><img src='../icons/previous.gif'
  border='0' height='32'  alt='Previous Page' width='32'></A></td>
<td><a rel="parent" title="What's New in Python" 
  HREF="whatsnew23.html"><img src='../icons/up.gif'
  border='0' height='32'  alt='Up One Level' width='32'></A></td>
<td><a rel="next" title="16 Other Language Changes" 
  HREF="node17.html"><img src='../icons/next.gif'
  border='0' height='32'  alt='Next Page' width='32'></A></td>
<td align="center" width="100%">What's New in Python 2.3</td>
<td><a rel="contents" title="Table of Contents" 
  href="contents.html"><img src='../icons/contents.gif'
  border='0' height='32'  alt='Contents' width='32'></A></td>
<td><img src='../icons/blank.gif'
  border='0' height='32'  alt='' width='32'></td>
</tr></table>
<b class="navlabel">Previous:</b>
<a class="sectref" rel="prev" href="section-pep305.html">14 PEP 307: Pickle</A>
<b class="navlabel">Up:</b>
<a class="sectref" rel="parent" HREF="whatsnew23.html">What's New in Python</A>
<b class="navlabel">Next:</b>
<a class="sectref" rel="next" HREF="node17.html">16 Other Language Changes</A>
<br><hr>
</DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION0001600000000000000000">&nbsp;</A>
<BR>
15 Extended Slices
</H1>

<P>
Ever since Python 1.4, the slicing syntax has supported an optional
third ``step'' or ``stride'' argument.  For example, these are all
legal Python syntax: <code>L[1:10:2]</code>, <code>L[:-1:1]</code>,
<code>L[::-1]</code>.  This was added to Python at the request of
the developers of Numerical Python, which uses the third argument
extensively.  However, Python's built-in list, tuple, and string
sequence types have never supported this feature, raising a
<tt class="exception">TypeError</tt> if you tried it.  Michael Hudson contributed a
patch to fix this shortcoming.

<P>
For example, you can now easily extract the elements of a list that
have even indexes:

<P>
<div class="verbatim"><pre>
&gt;&gt;&gt; L = range(10)
&gt;&gt;&gt; L[::2]
[0, 2, 4, 6, 8]
</pre></div>

<P>
Negative values also work to make a copy of the same list in reverse
order:

<P>
<div class="verbatim"><pre>
&gt;&gt;&gt; L[::-1]
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
</pre></div>

<P>
This also works for tuples, arrays, and strings:

<P>
<div class="verbatim"><pre>
&gt;&gt;&gt; s='abcd'
&gt;&gt;&gt; s[::2]
'ac'
&gt;&gt;&gt; s[::-1]
'dcba'
</pre></div>

<P>
If you have a mutable sequence such as a list or an array you can
assign to or delete an extended slice, but there are some differences
between assignment to extended and regular slices.  Assignment to a
regular slice can be used to change the length of the sequence:

<P>
<div class="verbatim"><pre>
&gt;&gt;&gt; a = range(3)
&gt;&gt;&gt; a
[0, 1, 2]
&gt;&gt;&gt; a[1:3] = [4, 5, 6]
&gt;&gt;&gt; a
[0, 4, 5, 6]
</pre></div>

<P>
Extended slices aren't this flexible.  When assigning to an extended
slice, the list on the right hand side of the statement must contain
the same number of items as the slice it is replacing:

<P>
<div class="verbatim"><pre>
&gt;&gt;&gt; a = range(4)
&gt;&gt;&gt; a
[0, 1, 2, 3]
&gt;&gt;&gt; a[::2]
[0, 2]
&gt;&gt;&gt; a[::2] = [0, -1]
&gt;&gt;&gt; a
[0, 1, -1, 3]
&gt;&gt;&gt; a[::2] = [0,1,2]
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in ?
ValueError: attempt to assign sequence of size 3 to extended slice of size 2
</pre></div>

<P>
Deletion is more straightforward:

<P>
<div class="verbatim"><pre>
&gt;&gt;&gt; a = range(4)
&gt;&gt;&gt; a
[0, 1, 2, 3]
&gt;&gt;&gt; a[::2]
[0, 2]
&gt;&gt;&gt; del a[::2]
&gt;&gt;&gt; a
[1, 3]
</pre></div>

<P>
One can also now pass slice objects to the
<tt class="method">__getitem__</tt> methods of the built-in sequences:

<P>
<div class="verbatim"><pre>
&gt;&gt;&gt; range(10).__getitem__(slice(0, 5, 2))
[0, 2, 4]
</pre></div>

<P>
Or use slice objects directly in subscripts:

<P>
<div class="verbatim"><pre>
&gt;&gt;&gt; range(10)[slice(0, 5, 2)]
[0, 2, 4]
</pre></div>

<P>
To simplify implementing sequences that support extended slicing,
slice objects now have a method <tt class="method">indices(<var>length</var>)</tt> which,
given the length of a sequence, returns a <code>(<var>start</var>,
<var>stop</var>, <var>step</var>)</code> tuple that can be passed directly to
<tt class="function">range()</tt>.
<tt class="method">indices()</tt> handles omitted and out-of-bounds indices in a
manner consistent with regular slices (and this innocuous phrase hides
a welter of confusing details!).  The method is intended to be used
like this:

<P>
<div class="verbatim"><pre>
class FakeSeq:
    ...
    def calc_item(self, i):
        ...
    def __getitem__(self, item):
        if isinstance(item, slice):
            indices = item.indices(len(self))
            return FakeSeq([self.calc_item(i) for i in range(*indices)])
        else:
            return self.calc_item(i)
</pre></div>

<P>
From this example you can also see that the built-in <tt class="class">slice</tt>
object is now the type object for the slice type, and is no longer a
function.  This is consistent with Python 2.2, where <tt class="class">int</tt>,
<tt class="class">str</tt>, etc., underwent the same change.

<P>

<DIV CLASS="navigation">
<p><hr>
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td><a rel="prev" title="14 PEP 307: Pickle" 
  rel="prev" title="14 PEP 307: Pickle" 
  href="section-pep305.html"><img src='../icons/previous.gif'
  border='0' height='32'  alt='Previous Page' width='32'></A></td>
<td><a rel="parent" title="What's New in Python" 
  rel="parent" title="What's New in Python" 
  HREF="whatsnew23.html"><img src='../icons/up.gif'
  border='0' height='32'  alt='Up One Level' width='32'></A></td>
<td><a rel="next" title="16 Other Language Changes" 
  rel="next" title="16 Other Language Changes" 
  HREF="node17.html"><img src='../icons/next.gif'
  border='0' height='32'  alt='Next Page' width='32'></A></td>
<td align="center" width="100%">What's New in Python 2.3</td>
<td><a rel="contents" title="Table of Contents" 
  rel="contents" title="Table of Contents" 
  href="contents.html"><img src='../icons/contents.gif'
  border='0' height='32'  alt='Contents' width='32'></A></td>
<td><img src='../icons/blank.gif'
  border='0' height='32'  alt='' width='32'></td>
</tr></table>
<b class="navlabel">Previous:</b>
<a class="sectref" rel="prev" href="section-pep305.html">14 PEP 307: Pickle</A>
<b class="navlabel">Up:</b>
<a class="sectref" rel="parent" HREF="whatsnew23.html">What's New in Python</A>
<b class="navlabel">Next:</b>
<a class="sectref" rel="next" HREF="node17.html">16 Other Language Changes</A>
<hr>
<span class="release-info">Release 1.00.</span>
</DIV>
<!--End of Navigation Panel-->
<ADDRESS>
See <i><a href="about.html">About this document...</a></i> for information on suggesting changes.
</ADDRESS>
</BODY>
</HTML>
